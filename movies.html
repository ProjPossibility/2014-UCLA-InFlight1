
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico">

    <title>Carousel Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="./bootstrap/css/bootstrap.min.css" rel="stylesheet">
  </head>

<!-- NAVBAR
================================================== -->
  <body>
    <div class="navbar-wrapper">
      <div class="container">
        <div class="navbar navbar-inverse navbar-static-top" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="./index.html">In Flight Entertainment</a>
            </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li><a href="./index.html">Home</a></li>
                <li class="active"><a href="./movies.html">Movies</a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Marketing messaging and featurettes
    ================================================== -->
    <!-- Wrap the rest of the page in another container to center all the content. -->

    <div class="container" id="movie-list">

    </div><!-- /.container -->
    <hr class="featurette-divider">
    <footer></footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="../bootstrap/js/bootstrap.min.js"></script>
    <!--<script src="../bootstrap/js/docs.min.js"></script>-->
    <script>

      var movie_titles = [];
      var movie_descriptions = [];

      $.getJSON( "http://localhost:1337/?data=movies", function( data ) {
        var items = [];
        for (var i = 0; i < data.movies.length; i++){
            items.push( "<hr class=\"featurette-divider\">" );
            items.push( "<div class=\"row featurette\">" );
            items.push( "<div class=\"col-md-3\">" );
            items.push( "<img class=\"featurette-image\" src=\"" + data.movies[i].image + "\">" );
            items.push( "</div>");
            items.push( "<div class=\"col-md-9\">" );
            items.push( "<h2 class= \"movie-title\">" + data.movies[i].title + "</h2>");
            items.push( "<p class=\"movie-description\">" + data.movies[i].description + "</p>");
            items.push( "<a href=\"" + data.movies[i].video + "\">Play Movie</a>" )
            items.push( "</div>");
            items.push( "</div>");

            movie_titles.push(data.movies[i].title);
            movie_descriptions.push(data.movies[i].description);
        }

        // reads out movie descriptions and titles
        for (var i = 0; i < movie_titles.length; i++){
          var voice_title = new SpeechSynthesisUtterance(movie_titles[i]);
          var voice_desc  = new SpeechSynthesisUtterance(movie_descriptions[i]);
          window.speechSynthesis.speak(voice_title);
          window.speechSynthesis.speak(voice_desc);
        }

        // adds movie poster, title, description to page
        $("<div/>", {
          "class": "row featurette",
          html: items.join("")
        }).appendTo("#movie-list");

      });
      console.log(movie_titles);
  
      var movie_selected_index = -1;
      var flag = true;
      document.addEventListener('click', function (event){
        window.speechSynthesis.cancel();
      })
      document.addEventListener('keydown', function(event){
        switch(event.keyCode)
        {
          case 40: // arrow key down
            if(movie_selected_index != 0)
            {
              movie_selected_index += 1;
              if (flag)
              {
                window.speechSynthesis.cancel();
                flag = false;
              }
            }
            break;
          case 38: // arrow key up
            if(movie_selected_index != movie_titles.length-1)
            {
              movie_selected_index += -1;
              flag = true;
            }
        }
      //       break;
      //     default:
      //       flag = false;
      //       break;
      //   }
      //   if (flag){
      //     window.speechSynthesis.pause();
      //     window.speechSynthesis.cancel();

      //     var voice_title = new SpeechSynthesisUtterance(movie_titles[movie_selected_index]);
      //     var voice_desc  = new SpeechSynthesisUtterance(movie_descriptions[movie_selected_index]);
      //     window.speechSynthesis.speak(voice_title);
      //     window.speechSynthesis.speak(voice_desc);

      //   }
      })
    </script>


  </body>
</html>
